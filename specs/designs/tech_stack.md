# 技術選定書

## 1. 概要

本プロジェクトでは、**高速なユーザー体験**と**Web 標準への適合**を最優先し、モダンなフロントエンド技術スタックを採用する。バックエンドを持たない「Frontend-only」アーキテクチャを実現するため、ブラウザ内で完結する技術を選定した。
また、OAuth 認証フローのために `tauri-plugin-deep-link` を採用し、カスタム URL スキーム (`waa-shell://`) のハンドリングを行う。

## 2. コア・フレームワーク

| カテゴリ         | 技術                        | 選定理由                                                                    |
| :--------------- | :-------------------------- | :-------------------------------------------------------------------------- |
| **Framework**    | **React 19**                | 宣言的 UI、豊富なエコシステム、Server/Client Components（将来的な拡張性）。 |
| **Build Tool**   | **Vite**                    | 圧倒的なビルド速度と HMR、プラグインのエコシステム。                        |
| **Language**     | **TypeScript**              | 型安全性による堅牢なコードベースの構築。                                    |
| **Runtime**      | **Browser (Tauri WebView)** | Native アプリとして配布しつつ、Web 技術で構築。                             |
| **Tauri Plugin** | **Global Shortcut**         | Raycast 風の呼び出し（ショートカットキー）を実現するため。                  |

## 3. スタイリング & UI

| カテゴリ       | 技術                       | 選定理由                                                                                                 |
| :------------- | :------------------------- | :------------------------------------------------------------------------------------------------------- |
| **Styling**    | **Tailwind CSS v4**        | (User Request) 最新の CSS 機能を活用し、ゼロランタイムで高速なスタイリング。CSS Variables ベースの設定。 |
| **UI Library** | **Radix UI / Headless UI** | アクセシビリティを確保しつつ、スタイルを完全に自由にカスタマイズ可能なヘッドレスコンポーネント。         |
| **Animation**  | **Framer Motion**          | 自然でリッチなマイクロインタラクションの実装。                                                           |
| **Icons**      | **Lucide React**           | モダンで統一感のあるアイコンセット。                                                                     |

## 4. 状態管理 & データ永続化

| カテゴリ           | 技術                     | 選定理由                                                                         |
| :----------------- | :----------------------- | :------------------------------------------------------------------------------- |
| **Local DB**       | **Dexie.js (IndexedDB)** | ブラウザ内での大容量データ（チャット履歴、ファイル）保存。使いやすい Query API。 |
| **State (Global)** | **Zustand**              | ボイラープレートの少ない軽量なステート管理。                                     |
| **State (Async)**  | **TanStack Query**       | 非同期データの取得、キャッシュ、同期管理（特に MCP や LLM レスポンス管理）。     |

## 5. アプリケーション機能

| カテゴリ             | 技術                            | 選定理由                                                 |
| :------------------- | :------------------------------ | :------------------------------------------------------- |
| **Routing**          | **TanStack Router**             | Type-safe なルーティング。Search Params の型安全な管理。 |
| **Markdown**         | **react-markdown** / **Remark** | チャット応答のレンダリング。                             |
| **Syntax Highlight** | **Shiki**                       | 美しいコードハイライト。                                 |
| **Math**             | **KaTeX**                       | 数式表示。                                               |

## 6. MCP & AI Integration

| カテゴリ       | 技術                            | 選定理由                                                                         |
| :------------- | :------------------------------ | :------------------------------------------------------------------------------- |
| **MCP Client** | **@modelcontextprotocol/sdk**   | (New) Streamable HTTP, SSE などの最新プロトコル対応。接続管理の抽象化。          |
| **LLM Client** | **Multiple SDKs**              | @google/genai, @anthropic-ai/sdk, OpenAI SDK 等を使い分け。 |
| **Auth**       | **OIDC / Proof Key (PKCE)**     | セキュアなリモート MCP 連携。Deep Link を介したログインフロー。              |
